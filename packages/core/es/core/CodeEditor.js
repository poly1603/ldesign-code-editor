import*as t from"monaco-editor";import{normalizeLanguage as e}from"../utils/language-utils.js";var i=Object.defineProperty,o=(t,e,o)=>(((t,e,o)=>{e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o})(t,"symbol"!=typeof e?e+"":e,o),o);class s{constructor(t,e={}){o(this,"editor",null),o(this,"container"),o(this,"config"),o(this,"disposables",[]),this.container=t,this.config=e,this.init()}init(){const e=this.buildMonacoOptions();this.editor=t.editor.create(this.container,e),this.setupEventListeners(),this.config.on?.ready&&this.config.on.ready(this.editor),this.setupResizeObserver()}buildMonacoOptions(){const{language:t="javascript",theme:i="vs-dark",value:o="",readOnly:s=!1,autoComplete:n=!0,folding:r=!0,lineNumbers:a="on",minimap:d=!0,fontSize:l=14,tabSize:u=2,insertSpaces:h=!0,wordWrap:c="off",scrollbar:g={},monacoOptions:p={}}=this.config;return{value:o,language:e(t),theme:i,readOnly:s,fontSize:l,tabSize:u,insertSpaces:h,wordWrap:c,lineNumbers:a,folding:r,automaticLayout:!0,minimap:{enabled:d},scrollbar:{vertical:g.vertical||"auto",horizontal:g.horizontal||"auto",verticalScrollbarSize:g.verticalScrollbarSize||10,horizontalScrollbarSize:g.horizontalScrollbarSize||10,useShadows:!1},quickSuggestions:n,suggestOnTriggerCharacters:n,parameterHints:{enabled:n},...p}}setupEventListeners(){if(!this.editor)return;const{on:t}=this.config;if(t?.change){const e=this.editor.onDidChangeModelContent(e=>{t.change(this.getValue(),e)});this.disposables.push(e)}if(t?.cursorChange){const e=this.editor.onDidChangeCursorPosition(e=>{t.cursorChange(e.position)});this.disposables.push(e)}if(t?.focus){const e=this.editor.onDidFocusEditorText(()=>{t.focus()});this.disposables.push(e)}if(t?.blur){const e=this.editor.onDidBlurEditorText(()=>{t.blur()});this.disposables.push(e)}}setupResizeObserver(){if(!this.editor)return;const t=new ResizeObserver(()=>{this.editor?.layout()});t.observe(this.container),this.disposables.push({dispose:()=>t.disconnect()})}getValue(){return this.editor?.getValue()||""}setValue(t){this.editor?.setValue(t)}getSelection(){if(!this.editor)return"";const t=this.editor.getSelection();return t&&this.editor.getModel()?.getValueInRange(t)||""}setSelection(t){this.editor?.setSelection(t)}insertText(e,i){if(!this.editor)return;const o=i||this.editor.getPosition();o&&this.editor.executeEdits("insert",[{range:new t.Range(o.lineNumber,o.column,o.lineNumber,o.column),text:e}])}async format(){this.editor&&await(this.editor.getAction("editor.action.formatDocument")?.run())}setLanguage(i){if(!this.editor)return;const o=this.editor.getModel();if(o){const s=e(i);t.editor.setModelLanguage(o,s)}}setTheme(e){t.editor.setTheme(e)}setReadOnly(t){this.editor?.updateOptions({readOnly:t})}focus(){this.editor?.focus()}getPosition(){return this.editor?.getPosition()||null}setPosition(t){this.editor?.setPosition(t)}undo(){this.editor?.trigger("keyboard","undo",null)}redo(){this.editor?.trigger("keyboard","redo",null)}getEditor(){if(!this.editor)throw new Error("Editor is not initialized");return this.editor}updateOptions(t){if(!this.editor)return;this.config={...this.config,...t};const e=this.buildMonacoOptions();this.editor.updateOptions(e),t.language&&this.setLanguage(t.language),t.theme&&this.setTheme(t.theme)}getState(){const t=this.getPosition(),e=this.editor?.getModel();return{language:e?.getLanguageId()||"javascript",theme:this.config.theme||"vs-dark",position:t,lineNumber:t?.lineNumber||0,column:t?.column||0,lineCount:e?.getLineCount()||0,readOnly:this.config.readOnly||!1}}dispose(){this.disposables.forEach(t=>t.dispose()),this.disposables=[],this.editor?.dispose(),this.editor=null,this.config.on?.dispose&&this.config.on.dispose()}}function n(t,e={}){const i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error("Container element not found");return new s(i,e)}export{s as CodeEditor,n as createCodeEditor};
//# sourceMappingURL=CodeEditor.js.map
