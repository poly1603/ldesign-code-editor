import*as e from"monaco-editor";var t=Object.defineProperty,i=(e,i,o)=>(((e,i,o)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[i]=o})(e,"symbol"!=typeof i?i+"":i,o),o);class o{constructor(e){i(this,"editor",null),i(this,"diffEditor",null),i(this,"features",{}),e&&this.setEditor(e)}setEditor(e){this.editor=e,this.applyFeatures()}configureFeatures(e){this.features={...this.features,...e},this.applyFeatures()}applyFeatures(){if(!this.editor)return;const e={};void 0!==this.features.bracketMatching&&(e.matchBrackets=this.features.bracketMatching?"always":"never"),void 0!==this.features.folding&&(e.folding=this.features.folding,e.foldingStrategy="indentation",e.foldingHighlight=!0,e.showFoldingControls="always"),void 0!==this.features.find&&(e.find={seedSearchStringFromSelection:"always",autoFindInSelection:"multiline",addExtraSpaceOnTop:!0}),void 0!==this.features.minimap&&(e.minimap={enabled:this.features.minimap,showSlider:"mouseover",renderCharacters:!0,maxColumn:80}),void 0!==this.features.breadcrumbs&&(e.renderWhitespace="selection"),void 0!==this.features.multiCursor&&(e.multiCursorModifier="alt",e.multiCursorMergeOverlapping=!0),this.editor.updateOptions(e)}enableMultiCursor(){this.editor&&(this.editor.updateOptions({multiCursorModifier:"alt",multiCursorMergeOverlapping:!0,multiCursorPaste:"spread"}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyCode.KeyD,()=>{this.editor?.trigger("keyboard","editor.action.addSelectionToNextFindMatch",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyL,()=>{this.editor?.trigger("keyboard","editor.action.selectHighlights",null)}))}addCustomKeybindings(){this.editor&&(this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyD,()=>{this.editor?.trigger("keyboard","editor.action.copyLinesDownAction",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyK,()=>{this.editor?.trigger("keyboard","editor.action.deleteLines",null)}),this.editor.addCommand(e.KeyMod.Alt|e.KeyCode.UpArrow,()=>{this.editor?.trigger("keyboard","editor.action.moveLinesUpAction",null)}),this.editor.addCommand(e.KeyMod.Alt|e.KeyCode.DownArrow,()=>{this.editor?.trigger("keyboard","editor.action.moveLinesDownAction",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyF,()=>{this.editor?.trigger("keyboard","editor.action.formatDocument",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyCode.Slash,()=>{this.editor?.trigger("keyboard","editor.action.commentLine",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyA,()=>{this.editor?.trigger("keyboard","editor.action.blockComment",null)}))}enhanceFolding(){this.editor&&(this.editor.updateOptions({folding:!0,foldingStrategy:"indentation",foldingHighlight:!0,showFoldingControls:"always",foldingImportsByDefault:!0}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.BracketLeft,()=>{this.editor?.trigger("keyboard","editor.foldAll",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.BracketRight,()=>{this.editor?.trigger("keyboard","editor.unfoldAll",null)}))}enableSmartBrackets(){this.editor&&(this.editor.updateOptions({autoClosingBrackets:"languageDefined",autoClosingQuotes:"languageDefined",autoSurround:"languageDefined",matchBrackets:"always",bracketPairColorization:{enabled:!0,independentColorPoolPerBracketType:!0}}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.Backslash,()=>{this.editor?.trigger("keyboard","editor.action.jumpToBracket",null)}))}enableEnhancedFind(){this.editor&&(this.editor.updateOptions({find:{seedSearchStringFromSelection:"always",autoFindInSelection:"multiline",addExtraSpaceOnTop:!0,loop:!0}}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyCode.KeyF,()=>{this.editor?.trigger("keyboard","actions.find",null)}),this.editor.addCommand(e.KeyMod.CtrlCmd|e.KeyCode.KeyH,()=>{this.editor?.trigger("keyboard","editor.action.startFindReplaceAction",null)}))}createDiffEditor(t,i,o,d){this.diffEditor=e.editor.createDiffEditor(t,{enableSplitViewResizing:!0,renderSideBySide:!0,readOnly:!1,automaticLayout:!0});const r=e.editor.createModel(i,d),n=e.editor.createModel(o,d);return this.diffEditor.setModel({original:r,modified:n}),this.diffEditor}toggleInlineDiff(){this.diffEditor&&this.diffEditor.updateOptions({renderSideBySide:!1})}registerCodeActions(t){e.languages.registerCodeActionProvider(t,{provideCodeActions:(e,t,i,o)=>{const d=[];return i.markers.length>0&&d.push({title:"快速修复",kind:"quickfix",diagnostics:i.markers,edit:{edits:[]}}),d.push({title:"提取到函数",kind:"refactor.extract",edit:{edits:[]}}),d.push({title:"自动导入",kind:"source.organizeImports",edit:{edits:[]}}),{actions:d,dispose:()=>{}}}})}enableSmartSelect(){this.editor&&(this.editor.addCommand(e.KeyMod.Shift|e.KeyMod.Alt|e.KeyCode.RightArrow,()=>{this.editor?.trigger("keyboard","editor.action.smartSelect.expand",null)}),this.editor.addCommand(e.KeyMod.Shift|e.KeyMod.Alt|e.KeyCode.LeftArrow,()=>{this.editor?.trigger("keyboard","editor.action.smartSelect.shrink",null)}))}enableColumnSelection(){this.editor&&(this.editor.updateOptions({columnSelection:!0}),this.editor.addCommand(e.KeyMod.Shift|e.KeyMod.Alt|e.KeyCode.DownArrow,()=>{this.editor?.trigger("keyboard","cursorColumnSelectDown",null)}),this.editor.addCommand(e.KeyMod.Shift|e.KeyMod.Alt|e.KeyCode.UpArrow,()=>{this.editor?.trigger("keyboard","cursorColumnSelectUp",null)}))}registerCodeLens(t){e.languages.registerCodeLensProvider(t,{provideCodeLenses:(t,i)=>{const o=[];return t.getLinesContent().forEach((t,i)=>{(t.includes("function")||t.includes("const")||t.includes("class"))&&o.push({range:new e.Range(i+1,1,i+1,1),command:{id:"editor.action.showReferences",title:"显示引用"}})}),{lenses:o,dispose:()=>{}}},resolveCodeLens:(e,t,i)=>t})}enhanceMinimap(){this.editor&&this.editor.updateOptions({minimap:{enabled:!0,showSlider:"always",renderCharacters:!1,maxColumn:120,scale:1,side:"right"}})}addContextMenuItems(){this.editor&&(this.editor.addAction({id:"custom-copy-path",label:"复制文件路径",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:e=>{}}),this.editor.addAction({id:"custom-format-selection",label:"格式化选中内容",keybindings:[e.KeyMod.CtrlCmd|e.KeyMod.Shift|e.KeyCode.KeyI],contextMenuGroupId:"1_modification",contextMenuOrder:2.5,run:e=>{e.trigger("keyboard","editor.action.formatSelection",null)}}))}enableAllEnhancements(){this.enableMultiCursor(),this.addCustomKeybindings(),this.enhanceFolding(),this.enableSmartBrackets(),this.enableEnhancedFind(),this.enableSmartSelect(),this.enableColumnSelection(),this.enhanceMinimap(),this.addContextMenuItems()}getEditorStats(){if(!this.editor)return{lineCount:0,wordCount:0,characterCount:0,selectionCount:0};const e=this.editor.getModel();if(!e)return{lineCount:0,wordCount:0,characterCount:0,selectionCount:0};const t=e.getValue(),i=t.match(/\b\w+\b/g)||[],o=this.editor.getSelections()||[];return{lineCount:e.getLineCount(),wordCount:i.length,characterCount:t.length,selectionCount:o.length}}dispose(){this.diffEditor&&(this.diffEditor.dispose(),this.diffEditor=null),this.editor=null}}function d(e){return new o(e)}export{o as EditorFeatureManager,d as createFeatureManager};
//# sourceMappingURL=features.js.map
