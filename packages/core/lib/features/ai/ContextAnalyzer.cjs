"use strict";exports.ContextAnalyzer=class{analyzeContext(t,e){const n=t.getValue(),s=t.getOffsetAt(e);return{beforeCursor:n.substring(0,s),afterCursor:n.substring(s),currentLine:t.getLineContent(e.lineNumber),language:t.getLanguageId(),fileName:t.uri.path,imports:this.extractImports(n),functions:this.extractFunctions(n),variables:this.extractVariables(n)}}extractImports(t){const e=[],n=/import\s+.*?\s+from\s+['"](.*?)['"]/g,s=/require\(['"](.*?)['"]\)/g;let r;for(;null!==(r=n.exec(t));)e.push(r[1]);for(;null!==(r=s.exec(t));)e.push(r[1]);return[...new Set(e)]}extractFunctions(t){const e=[],n=/function\s+(\w+)\s*\(/g,s=/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s*)?\([^)]*\)\s*=>/g,r=/(\w+)\s*\([^)]*\)\s*\{/g;let i;for(;null!==(i=n.exec(t));)e.push(i[1]);for(;null!==(i=s.exec(t));)e.push(i[1]);for(;null!==(i=r.exec(t));)["if","for","while","switch"].includes(i[1])||e.push(i[1]);return[...new Set(e)]}extractVariables(t){const e=[],n=/(?:const|let|var)\s+(\w+)/g;let s;for(;null!==(s=n.exec(t));)e.push(s[1]);return[...new Set(e)]}getCurrentScope(t,e){const n=t.getValue(),s=t.getOffsetAt(e),r=n.substring(0,s);let i=0,o=0;for(let t=r.length-1;t>=0;t--)if("}"===r[t])i++;else if("{"===r[t]){if(0===i){o=t;break}i--}return n.substring(o,s)}detectContextType(t){const{currentLine:e,beforeCursor:n}=t;return e.trim().startsWith("//")||e.trim().startsWith("/*")?"comment":n.match(/['"`](?:[^'"`\\]|\\.)*$/)?"string":e.includes("import")||e.includes("require")?"import":e.includes("function")||/=>\s*{?$/.test(n)?"function":e.includes("class")?"class":/(?:const|let|var)\s+\w*$/.test(n)?"variable":"unknown"}getWordBeforeCursor(t,e){const n=t.getLineContent(e.lineNumber).substring(0,e.column-1).match(/[\w.]+$/);return n?n[0]:""}getCompletionContext(t){const e=this.detectContextType(t);return{inFunction:"function"===e,inClass:"class"===e,inString:"string"===e,inComment:"comment"===e,availableVariables:t.variables||[],availableFunctions:t.functions||[]}}};
//# sourceMappingURL=ContextAnalyzer.cjs.map
