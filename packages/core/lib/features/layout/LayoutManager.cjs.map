{"version":3,"file":"LayoutManager.cjs","sources":["../../../src/features/layout/LayoutManager.ts"],"sourcesContent":["/**\n * 编辑器布局管理器\n */\n\nimport type * as Monaco from 'monaco-editor'\n\nexport interface LayoutConfig {\n  type: 'single' | 'horizontal' | 'vertical' | 'grid'\n  sizes?: number[]\n  editors?: Array<{\n    id: string\n    content: string\n    language: string\n  }>\n}\n\nexport interface EditorPane {\n  id: string\n  editor: Monaco.editor.IStandaloneCodeEditor\n  container: HTMLElement\n  size: number\n}\n\nexport class LayoutManager {\n  private panes: EditorPane[] = []\n  private container: HTMLElement\n  private currentLayout: LayoutConfig['type'] = 'single'\n\n  constructor(container: HTMLElement) {\n    this.container = container\n  }\n\n  setLayout(config: LayoutConfig): void {\n    this.currentLayout = config.type\n    this.applyLayout(config)\n  }\n\n  splitHorizontal(): void {\n    this.setLayout({ type: 'horizontal', sizes: [50, 50] })\n  }\n\n  splitVertical(): void {\n    this.setLayout({ type: 'vertical', sizes: [50, 50] })\n  }\n\n  addPane(pane: EditorPane): void {\n    this.panes.push(pane)\n  }\n\n  removePane(id: string): void {\n    const index = this.panes.findIndex((p) => p.id === id)\n    if (index !== -1) {\n      this.panes[index].editor.dispose()\n      this.panes[index].container.remove()\n      this.panes.splice(index, 1)\n    }\n  }\n\n  getPanes(): EditorPane[] {\n    return [...this.panes]\n  }\n\n  private applyLayout(config: LayoutConfig): void {\n    const { type, sizes = [] } = config\n\n    switch (type) {\n      case 'horizontal':\n        this.applyHorizontalLayout(sizes)\n        break\n      case 'vertical':\n        this.applyVerticalLayout(sizes)\n        break\n      case 'grid':\n        this.applyGridLayout()\n        break\n      default:\n        this.applySingleLayout()\n    }\n  }\n\n  private applyHorizontalLayout(sizes: number[]): void {\n    this.container.style.display = 'flex'\n    this.container.style.flexDirection = 'row'\n    this.panes.forEach((pane, index) => {\n      const size = sizes[index] || 100 / this.panes.length\n      pane.container.style.width = `${size}%`\n      pane.container.style.height = '100%'\n    })\n  }\n\n  private applyVerticalLayout(sizes: number[]): void {\n    this.container.style.display = 'flex'\n    this.container.style.flexDirection = 'column'\n    this.panes.forEach((pane, index) => {\n      const size = sizes[index] || 100 / this.panes.length\n      pane.container.style.height = `${size}%`\n      pane.container.style.width = '100%'\n    })\n  }\n\n  private applyGridLayout(): void {\n    this.container.style.display = 'grid'\n    this.container.style.gridTemplateColumns = 'repeat(2, 1fr)'\n    this.container.style.gridTemplateRows = 'repeat(2, 1fr)'\n  }\n\n  private applySingleLayout(): void {\n    this.container.style.display = 'block'\n    this.panes.forEach((pane) => {\n      pane.container.style.width = '100%'\n      pane.container.style.height = '100%'\n    })\n  }\n\n  saveLayout(): LayoutConfig {\n    return {\n      type: this.currentLayout,\n      sizes: this.panes.map((p) => p.size),\n      editors: this.panes.map((p) => ({\n        id: p.id,\n        content: p.editor.getValue(),\n        language: p.editor.getModel()?.getLanguageId() || 'javascript',\n      })),\n    }\n  }\n\n  dispose(): void {\n    this.panes.forEach((pane) => {\n      pane.editor.dispose()\n      pane.container.remove()\n    })\n    this.panes = []\n  }\n}\n\n"],"names":["n","Object","defineProperty","o","a","t","e","enumerable","configurable","writable","value","r","constructor","container","__publicField","this","setLayout","config","currentLayout","type","applyLayout","splitHorizontal","sizes","splitVertical","addPane","pane","panes","push","removePane","id","index","findIndex","p","editor","dispose","remove","splice","getPanes","applyHorizontalLayout","applyVerticalLayout","applyGridLayout","applySingleLayout","style","display","flexDirection","forEach","size","length","width","height","gridTemplateColumns","gridTemplateRows","saveLayout","map","editors","content","getValue","language","getModel","getLanguageId"],"mappings":"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"}