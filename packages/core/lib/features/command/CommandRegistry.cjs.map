{"version":3,"file":"CommandRegistry.cjs","sources":["../../../src/features/command/CommandRegistry.ts"],"sourcesContent":["/**\n * 命令注册中心\n */\n\nexport interface Command {\n  id: string\n  title: string\n  category?: string\n  keybinding?: string\n  handler: (...args: unknown[]) => void | Promise<void>\n}\n\nexport class CommandRegistry {\n  private commands = new Map<string, Command>()\n  private aliases = new Map<string, string>()\n  private history: string[] = []\n  private maxHistorySize = 50\n\n  registerCommand(command: Command): void {\n    this.commands.set(command.id, command)\n  }\n\n  unregisterCommand(id: string): boolean {\n    return this.commands.delete(id)\n  }\n\n  registerAlias(alias: string, commandId: string): void {\n    this.aliases.set(alias, commandId)\n  }\n\n  getCommand(idOrAlias: string): Command | undefined {\n    const commandId = this.aliases.get(idOrAlias) || idOrAlias\n    return this.commands.get(commandId)\n  }\n\n  getAllCommands(): Command[] {\n    return Array.from(this.commands.values())\n  }\n\n  searchCommands(query: string): Command[] {\n    const lowerQuery = query.toLowerCase()\n    return this.getAllCommands().filter(\n      (cmd) =>\n        cmd.title.toLowerCase().includes(lowerQuery) ||\n        cmd.id.toLowerCase().includes(lowerQuery) ||\n        cmd.category?.toLowerCase().includes(lowerQuery)\n    )\n  }\n\n  async executeCommand(id: string, ...args: unknown[]): Promise<void> {\n    const command = this.getCommand(id)\n    if (!command) {\n      throw new Error(`Command not found: ${id}`)\n    }\n\n    this.addToHistory(id)\n    await command.handler(...args)\n  }\n\n  getHistory(): string[] {\n    return [...this.history]\n  }\n\n  private addToHistory(id: string): void {\n    this.history.unshift(id)\n    if (this.history.length > this.maxHistorySize) {\n      this.history = this.history.slice(0, this.maxHistorySize)\n    }\n  }\n\n  clearHistory(): void {\n    this.history = []\n  }\n}\n\nexport const commandRegistry = new CommandRegistry()\n\n"],"names":["CommandRegistry","constructor","__publicField","this","Map","registerCommand","command","commands","set","id","unregisterCommand","delete","registerAlias","alias","commandId","aliases","getCommand","idOrAlias","get","getAllCommands","Array","from","values","searchCommands","query","lowerQuery","toLowerCase","filter","cmd","title","includes","category","executeCommand","args","Error","addToHistory","handler","getHistory","history","unshift","length","maxHistorySize","slice","clearHistory","commandRegistry"],"mappings":"6KAYO,MAAMA,EAAN,WAAAC,GACLC,EAAAC,KAAQ,WAAW,IAAIC,KACvBF,EAAAC,KAAQ,UAAU,IAAIC,KACtBF,EAAAC,KAAQ,UAAoB,IAC5BD,EAAAC,KAAQ,iBAAiB,GAAA,CAEzB,eAAAE,CAAgBC,GACdH,KAAKI,SAASC,IAAIF,EAAQG,GAAIH,EAChC,CAEA,iBAAAI,CAAkBD,GAChB,OAAON,KAAKI,SAASI,OAAOF,EAC9B,CAEA,aAAAG,CAAcC,EAAeC,GAC3BX,KAAKY,QAAQP,IAAIK,EAAOC,EAC1B,CAEA,UAAAE,CAAWC,GACT,MAAMH,EAAYX,KAAKY,QAAQG,IAAID,IAAcA,EACjD,OAAOd,KAAKI,SAASW,IAAIJ,EAC3B,CAEA,cAAAK,GACE,OAAOC,MAAMC,KAAKlB,KAAKI,SAASe,SAClC,CAEA,cAAAC,CAAeC,GACb,MAAMC,EAAaD,EAAME,cACzB,OAAOvB,KAAKgB,iBAAiBQ,OAC1BC,GACCA,EAAIC,MAAMH,cAAcI,SAASL,IACjCG,EAAInB,GAAGiB,cAAcI,SAASL,IAC9BG,EAAIG,UAAUL,cAAcI,SAASL,GAE3C,CAEA,oBAAMO,CAAevB,KAAewB,GAClC,MAAM3B,EAAUH,KAAKa,WAAWP,GAChC,IAAKH,EACH,MAAM,IAAI4B,MAAM,sBAAsBzB,KAGxCN,KAAKgC,aAAa1B,SACZH,EAAQ8B,WAAWH,EAC3B,CAEA,UAAAI,GACE,MAAO,IAAIlC,KAAKmC,QAClB,CAEQ,YAAAH,CAAa1B,GACnBN,KAAKmC,QAAQC,QAAQ9B,GACjBN,KAAKmC,QAAQE,OAASrC,KAAKsC,iBAC7BtC,KAAKmC,QAAUnC,KAAKmC,QAAQI,MAAM,EAAGvC,KAAKsC,gBAE9C,CAEA,YAAAE,GACExC,KAAKmC,QAAU,EACjB,EAGK,MAAMM,EAAkB,IAAI5C"}