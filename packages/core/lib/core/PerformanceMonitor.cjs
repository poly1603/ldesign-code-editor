"use strict";var e=Object.defineProperty,r=(r,t,a)=>(((r,t,a)=>{t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a})(r,"symbol"!=typeof t?t+"":t,a),a);class t{constructor(e=1e3){r(this,"metrics",[]),r(this,"marks",new Map),r(this,"maxMetrics",1e3),r(this,"enabled",!0),this.maxMetrics=e}enable(){this.enabled=!0}disable(){this.enabled=!1}mark(e){this.enabled&&(this.marks.set(e,performance.now()),performance.mark&&performance.mark(e))}measure(e,r,t,a="custom"){if(!this.enabled)return null;try{let n;if(r&&this.marks.has(r)){const a=this.marks.get(r);if(n=(t&&this.marks.has(t)?this.marks.get(t):performance.now())-a,performance.measure)try{performance.measure(e,r,t)}catch{}}else n=0;return this.recordMetric(e,n,a),n}catch(e){return null}}recordMetric(e,r,t="custom"){if(!this.enabled)return;const a={name:e,value:r,timestamp:Date.now(),category:t};this.metrics.push(a),this.metrics.length>this.maxMetrics&&this.metrics.shift()}getMetrics(){return[...this.metrics]}getMetricsByCategory(e){return this.metrics.filter(r=>r.category===e)}getMetricsByName(e){return this.metrics.filter(r=>r.name===e)}generateReport(){const e=this.metrics.map(e=>e.value),r=this.metrics.reduce((e,r)=>(e[r.category]=(e[r.category]||0)+1,e),{});return{metrics:this.metrics,summary:{totalMetrics:this.metrics.length,averageValue:e.length>0?e.reduce((e,r)=>e+r,0)/e.length:0,minValue:e.length>0?Math.min(...e):0,maxValue:e.length>0?Math.max(...e):0},categories:r}}clear(){this.metrics=[],this.marks.clear(),performance.clearMarks&&performance.clearMarks(),performance.clearMeasures&&performance.clearMeasures()}getMemoryUsage(){if("memory"in performance&&performance.memory){const e=performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,limit:e.jsHeapSizeLimit}}return null}monitorFPS(e=1e3){return new Promise(r=>{let t,a=0,n=performance.now();const s=()=>{a++;const i=performance.now();if(i-n>=e){const e=1e3*a/(i-n);cancelAnimationFrame(t),r(e)}else t=requestAnimationFrame(s)};t=requestAnimationFrame(s)})}observeLongTasks(e=50){if("PerformanceObserver"in window)try{new PerformanceObserver(r=>{for(const t of r.getEntries())t.duration>e&&this.recordMetric(`long-task:${t.name}`,t.duration,"interaction")}).observe({entryTypes:["longtask","measure"]})}catch{}}getNavigationTiming(){if(!performance.timing)return null;const e=performance.timing,r=e.navigationStart;return{redirect:e.redirectEnd-e.redirectStart,dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,dom:e.domComplete-e.domLoading,load:e.loadEventEnd-e.loadEventStart,total:e.loadEventEnd-r}}exportToJSON(){return JSON.stringify(this.generateReport(),null,2)}exportToCSV(){return"Name,Value,Timestamp,Category\n"+this.metrics.map(e=>`${e.name},${e.value},${e.timestamp},${e.category}`).join("\n")}}const a=new t;exports.Measure=function(e="custom"){return function(r,a,n){const s=n.value,i=new t;return n.value=async function(...r){const t=`${a}-start`,n=`${a}-end`;i.mark(t);try{const o=await s.apply(this,r);return i.mark(n),i.measure(a,t,n,e),o}catch(r){throw i.mark(n),i.measure(`${a}-error`,t,n,e),r}},n}},exports.PerformanceMonitor=t,exports.globalPerformanceMonitor=a;
//# sourceMappingURL=PerformanceMonitor.cjs.map
