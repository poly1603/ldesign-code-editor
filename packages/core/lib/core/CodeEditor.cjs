"use strict";var e=require("monaco-editor"),t=require("../utils/language-utils.cjs");var i,o,s=(i=e,o=Object.create(null),i&&Object.keys(i).forEach(function(e){if("default"!==e){var t=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(o,e,t.get?t:{enumerable:!0,get:function(){return i[e]}})}}),o.default=i,Object.freeze(o)),r=Object.defineProperty,n=(e,t,i)=>(((e,t,i)=>{t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class a{constructor(e,t={}){n(this,"editor",null),n(this,"container"),n(this,"config"),n(this,"disposables",[]),this.container=e,this.config=t,this.init()}init(){const e=this.buildMonacoOptions();this.editor=s.editor.create(this.container,e),this.setupEventListeners(),this.config.on?.ready&&this.config.on.ready(this.editor),this.setupResizeObserver()}buildMonacoOptions(){const{language:e="javascript",theme:i="vs-dark",value:o="",readOnly:s=!1,autoComplete:r=!0,folding:n=!0,lineNumbers:a="on",minimap:d=!0,fontSize:u=14,tabSize:l=2,insertSpaces:c=!0,wordWrap:h="off",scrollbar:g={},monacoOptions:p={}}=this.config;return{value:o,language:t.normalizeLanguage(e),theme:i,readOnly:s,fontSize:u,tabSize:l,insertSpaces:c,wordWrap:h,lineNumbers:a,folding:n,automaticLayout:!0,minimap:{enabled:d},scrollbar:{vertical:g.vertical||"auto",horizontal:g.horizontal||"auto",verticalScrollbarSize:g.verticalScrollbarSize||10,horizontalScrollbarSize:g.horizontalScrollbarSize||10,useShadows:!1},quickSuggestions:r,suggestOnTriggerCharacters:r,parameterHints:{enabled:r},...p}}setupEventListeners(){if(!this.editor)return;const{on:e}=this.config;if(e?.change){const t=this.editor.onDidChangeModelContent(t=>{e.change(this.getValue(),t)});this.disposables.push(t)}if(e?.cursorChange){const t=this.editor.onDidChangeCursorPosition(t=>{e.cursorChange(t.position)});this.disposables.push(t)}if(e?.focus){const t=this.editor.onDidFocusEditorText(()=>{e.focus()});this.disposables.push(t)}if(e?.blur){const t=this.editor.onDidBlurEditorText(()=>{e.blur()});this.disposables.push(t)}}setupResizeObserver(){if(!this.editor)return;const e=new ResizeObserver(()=>{this.editor?.layout()});e.observe(this.container),this.disposables.push({dispose:()=>e.disconnect()})}getValue(){return this.editor?.getValue()||""}setValue(e){this.editor?.setValue(e)}getSelection(){if(!this.editor)return"";const e=this.editor.getSelection();return e&&this.editor.getModel()?.getValueInRange(e)||""}setSelection(e){this.editor?.setSelection(e)}insertText(e,t){if(!this.editor)return;const i=t||this.editor.getPosition();i&&this.editor.executeEdits("insert",[{range:new s.Range(i.lineNumber,i.column,i.lineNumber,i.column),text:e}])}async format(){this.editor&&await(this.editor.getAction("editor.action.formatDocument")?.run())}setLanguage(e){if(!this.editor)return;const i=this.editor.getModel();if(i){const o=t.normalizeLanguage(e);s.editor.setModelLanguage(i,o)}}setTheme(e){s.editor.setTheme(e)}setReadOnly(e){this.editor?.updateOptions({readOnly:e})}focus(){this.editor?.focus()}getPosition(){return this.editor?.getPosition()||null}setPosition(e){this.editor?.setPosition(e)}undo(){this.editor?.trigger("keyboard","undo",null)}redo(){this.editor?.trigger("keyboard","redo",null)}getEditor(){if(!this.editor)throw new Error("Editor is not initialized");return this.editor}updateOptions(e){if(!this.editor)return;this.config={...this.config,...e};const t=this.buildMonacoOptions();this.editor.updateOptions(t),e.language&&this.setLanguage(e.language),e.theme&&this.setTheme(e.theme)}getState(){const e=this.getPosition(),t=this.editor?.getModel();return{language:t?.getLanguageId()||"javascript",theme:this.config.theme||"vs-dark",position:e,lineNumber:e?.lineNumber||0,column:e?.column||0,lineCount:t?.getLineCount()||0,readOnly:this.config.readOnly||!1}}dispose(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.editor?.dispose(),this.editor=null,this.config.on?.dispose&&this.config.on.dispose()}}exports.CodeEditor=a,exports.createCodeEditor=function(e,t={}){const i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error("Container element not found");return new a(i,t)};
//# sourceMappingURL=CodeEditor.cjs.map
