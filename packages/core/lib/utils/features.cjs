"use strict";var e=require("monaco-editor");var t,i,o=(t=e,i=Object.create(null),t&&Object.keys(t).forEach(function(e){if("default"!==e){var o=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(i,e,o.get?o:{enumerable:!0,get:function(){return t[e]}})}}),i.default=t,Object.freeze(i)),d=Object.defineProperty,r=(e,t,i)=>(((e,t,i)=>{t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class n{constructor(e){r(this,"editor",null),r(this,"diffEditor",null),r(this,"features",{}),e&&this.setEditor(e)}setEditor(e){this.editor=e,this.applyFeatures()}configureFeatures(e){this.features={...this.features,...e},this.applyFeatures()}applyFeatures(){if(!this.editor)return;const e={};void 0!==this.features.bracketMatching&&(e.matchBrackets=this.features.bracketMatching?"always":"never"),void 0!==this.features.folding&&(e.folding=this.features.folding,e.foldingStrategy="indentation",e.foldingHighlight=!0,e.showFoldingControls="always"),void 0!==this.features.find&&(e.find={seedSearchStringFromSelection:"always",autoFindInSelection:"multiline",addExtraSpaceOnTop:!0}),void 0!==this.features.minimap&&(e.minimap={enabled:this.features.minimap,showSlider:"mouseover",renderCharacters:!0,maxColumn:80}),void 0!==this.features.breadcrumbs&&(e.renderWhitespace="selection"),void 0!==this.features.multiCursor&&(e.multiCursorModifier="alt",e.multiCursorMergeOverlapping=!0),this.editor.updateOptions(e)}enableMultiCursor(){this.editor&&(this.editor.updateOptions({multiCursorModifier:"alt",multiCursorMergeOverlapping:!0,multiCursorPaste:"spread"}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyCode.KeyD,()=>{this.editor?.trigger("keyboard","editor.action.addSelectionToNextFindMatch",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyL,()=>{this.editor?.trigger("keyboard","editor.action.selectHighlights",null)}))}addCustomKeybindings(){this.editor&&(this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyD,()=>{this.editor?.trigger("keyboard","editor.action.copyLinesDownAction",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyK,()=>{this.editor?.trigger("keyboard","editor.action.deleteLines",null)}),this.editor.addCommand(o.KeyMod.Alt|o.KeyCode.UpArrow,()=>{this.editor?.trigger("keyboard","editor.action.moveLinesUpAction",null)}),this.editor.addCommand(o.KeyMod.Alt|o.KeyCode.DownArrow,()=>{this.editor?.trigger("keyboard","editor.action.moveLinesDownAction",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyF,()=>{this.editor?.trigger("keyboard","editor.action.formatDocument",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyCode.Slash,()=>{this.editor?.trigger("keyboard","editor.action.commentLine",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyA,()=>{this.editor?.trigger("keyboard","editor.action.blockComment",null)}))}enhanceFolding(){this.editor&&(this.editor.updateOptions({folding:!0,foldingStrategy:"indentation",foldingHighlight:!0,showFoldingControls:"always",foldingImportsByDefault:!0}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.BracketLeft,()=>{this.editor?.trigger("keyboard","editor.foldAll",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.BracketRight,()=>{this.editor?.trigger("keyboard","editor.unfoldAll",null)}))}enableSmartBrackets(){this.editor&&(this.editor.updateOptions({autoClosingBrackets:"languageDefined",autoClosingQuotes:"languageDefined",autoSurround:"languageDefined",matchBrackets:"always",bracketPairColorization:{enabled:!0,independentColorPoolPerBracketType:!0}}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.Backslash,()=>{this.editor?.trigger("keyboard","editor.action.jumpToBracket",null)}))}enableEnhancedFind(){this.editor&&(this.editor.updateOptions({find:{seedSearchStringFromSelection:"always",autoFindInSelection:"multiline",addExtraSpaceOnTop:!0,loop:!0}}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyCode.KeyF,()=>{this.editor?.trigger("keyboard","actions.find",null)}),this.editor.addCommand(o.KeyMod.CtrlCmd|o.KeyCode.KeyH,()=>{this.editor?.trigger("keyboard","editor.action.startFindReplaceAction",null)}))}createDiffEditor(e,t,i,d){this.diffEditor=o.editor.createDiffEditor(e,{enableSplitViewResizing:!0,renderSideBySide:!0,readOnly:!1,automaticLayout:!0});const r=o.editor.createModel(t,d),n=o.editor.createModel(i,d);return this.diffEditor.setModel({original:r,modified:n}),this.diffEditor}toggleInlineDiff(){this.diffEditor&&this.diffEditor.updateOptions({renderSideBySide:!1})}registerCodeActions(e){o.languages.registerCodeActionProvider(e,{provideCodeActions:(e,t,i,o)=>{const d=[];return i.markers.length>0&&d.push({title:"快速修复",kind:"quickfix",diagnostics:i.markers,edit:{edits:[]}}),d.push({title:"提取到函数",kind:"refactor.extract",edit:{edits:[]}}),d.push({title:"自动导入",kind:"source.organizeImports",edit:{edits:[]}}),{actions:d,dispose:()=>{}}}})}enableSmartSelect(){this.editor&&(this.editor.addCommand(o.KeyMod.Shift|o.KeyMod.Alt|o.KeyCode.RightArrow,()=>{this.editor?.trigger("keyboard","editor.action.smartSelect.expand",null)}),this.editor.addCommand(o.KeyMod.Shift|o.KeyMod.Alt|o.KeyCode.LeftArrow,()=>{this.editor?.trigger("keyboard","editor.action.smartSelect.shrink",null)}))}enableColumnSelection(){this.editor&&(this.editor.updateOptions({columnSelection:!0}),this.editor.addCommand(o.KeyMod.Shift|o.KeyMod.Alt|o.KeyCode.DownArrow,()=>{this.editor?.trigger("keyboard","cursorColumnSelectDown",null)}),this.editor.addCommand(o.KeyMod.Shift|o.KeyMod.Alt|o.KeyCode.UpArrow,()=>{this.editor?.trigger("keyboard","cursorColumnSelectUp",null)}))}registerCodeLens(e){o.languages.registerCodeLensProvider(e,{provideCodeLenses:(e,t)=>{const i=[];return e.getLinesContent().forEach((e,t)=>{(e.includes("function")||e.includes("const")||e.includes("class"))&&i.push({range:new o.Range(t+1,1,t+1,1),command:{id:"editor.action.showReferences",title:"显示引用"}})}),{lenses:i,dispose:()=>{}}},resolveCodeLens:(e,t,i)=>t})}enhanceMinimap(){this.editor&&this.editor.updateOptions({minimap:{enabled:!0,showSlider:"always",renderCharacters:!1,maxColumn:120,scale:1,side:"right"}})}addContextMenuItems(){this.editor&&(this.editor.addAction({id:"custom-copy-path",label:"复制文件路径",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:e=>{}}),this.editor.addAction({id:"custom-format-selection",label:"格式化选中内容",keybindings:[o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyI],contextMenuGroupId:"1_modification",contextMenuOrder:2.5,run:e=>{e.trigger("keyboard","editor.action.formatSelection",null)}}))}enableAllEnhancements(){this.enableMultiCursor(),this.addCustomKeybindings(),this.enhanceFolding(),this.enableSmartBrackets(),this.enableEnhancedFind(),this.enableSmartSelect(),this.enableColumnSelection(),this.enhanceMinimap(),this.addContextMenuItems()}getEditorStats(){if(!this.editor)return{lineCount:0,wordCount:0,characterCount:0,selectionCount:0};const e=this.editor.getModel();if(!e)return{lineCount:0,wordCount:0,characterCount:0,selectionCount:0};const t=e.getValue(),i=t.match(/\b\w+\b/g)||[],o=this.editor.getSelections()||[];return{lineCount:e.getLineCount(),wordCount:i.length,characterCount:t.length,selectionCount:o.length}}dispose(){this.diffEditor&&(this.diffEditor.dispose(),this.diffEditor=null),this.editor=null}}exports.EditorFeatureManager=n,exports.createFeatureManager=function(e){return new n(e)};
//# sourceMappingURL=features.cjs.map
